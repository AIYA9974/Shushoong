<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kh.mclass.shushoong.servicecenter.model.repository.ServiceCenterRepository">
<select id="selectNoticeAllList" parameterType="map" resultType="NoticeDto">
	select * from notice_board 
  	<choose>
  		<when test="userGrade == 'admin and noticeCategory == null'">
			order by notice_time desc
		</when>
		<when test="userGrade == 'customer' and noticeCategory == null">
			where notice_id like '1%'
			order by notice_time desc
		</when>
		<when test="userGrade == 'business' and noticeCategory == null">
			where notice_id like '2%'
			order by notice_time desc
		</when>
	</choose>
	
</select>
<select id="selectNoticeAllListAjax" parameterType="map" resultType="NoticeDto">
	select * from notice_board 
  	<choose>
  		<when test="userGrade == 'admin' and noticeCategory == null">
			order by notice_time desc
		</when>
  		<when test="userGrade == 'admin' and noticeCategory == 1">
  			where notice_id like '1%'
			order by notice_time desc
		</when>
		<when test="userGrade == 'admin' and noticeCategory == 2">
			where notice_id like '2%'
			order by notice_time desc
		</when>
		<when test="userGrade == 'customer' ">
			where notice_id like '1%'
			order by notice_time desc
		</when>
		<when test="userGrade == 'business' ">
			where notice_id like '2%'
			order by notice_time desc
		</when>
	</choose>
	
</select>
<select id="selectNoticeTotalCount" parameterType="hashMap" resultType="int">
	<choose>
		<when test="userGrade == 'customer' and noticeCategory == null">
			select count (*) from notice_board where notice_id like '1%' 
		</when>
		<when test="userGrade == 'business' and noticeCategory == null">
			select count (*) from notice_board where notice_id like '2%' 
		</when>
		<when test="userGrade == 'admin' and noticeCategory == null">
			select count (*) from notice_board  
		</when>
		<when test="userGrade == 'admin' and noticeCategory == 1">
			select count (*) from notice_board where notice_id like '1%'  
		</when>
		<when test="userGrade == 'admin' and noticeCategory == 2">
			select count (*) from notice_board where notice_id like '2%'  
		</when>
	</choose>
</select>
<insert id="insertNotice" parameterType="NoticeDto">
	<choose>
		<when test="noticeCategory == 1">
			insert into notice_board values(
			1||SEQ_NOTICE_ID.nextval, #{noticeTitle}, #{noticeContent}, SYSDATE, #{userId}
			)
		</when>
		<when test="noticeCategory != 1">
			insert into notice_board values(
			2||SEQ_NOTICE_ID.nextval, #{noticeTitle}, #{noticeContent}, SYSDATE, #{userId}
			)
		</when>
	</choose>
</insert>
<insert id="insertNoticeFile" parameterType="NoticeFileDto">
	insert into notice_file values(
	#{notice_id}+1, #{notice_id}, #{originalFilename}, #{savedFilePathName}
	)
</insert>
<select id="selectOneNotice" parameterType="String" resultType="noticeDto">
	select * from notice_board where notice_id = #{noticeId}
</select>
<update id="updateNotice" parameterType="hashMap">
			update notice_board set notice_time = sysdate, notice_title = #{noticeTitle}, 
			notice_content = #{noticeContent} where notice_id = #{noticeId}
			<!-- 
	<choose>
		<when test="noticeCategory == 1">
			update notice_board set notice_time = sysdate, notice_title = #{noticeTitle}, 
			notice_content=#{noticeContent} where notice_id = #{noticeId}	
		</when>
		<when test="noticeCategory != 1">	
			update notice_board set notice_time = sysdate, notice_title = #{noticeTitle}, 
			notice_content=#{noticeContent} where notice_id = #{noticeId}
		</when>
	</choose>
	 -->
</update>
<delete id="deleteNotice" parameterType="hashMap">
	delete notice_board where notice_id = #{noticeId}
</delete>
</mapper>